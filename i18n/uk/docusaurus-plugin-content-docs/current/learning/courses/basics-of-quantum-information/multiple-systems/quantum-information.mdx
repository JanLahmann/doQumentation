---
title: "Квантова інформація"
sidebar_label: "Квантова інформація"
description: "Безкоштовний курс IBM з квантової інформації та обчислень"
notebook_path: "learning/courses/basics-of-quantum-information/multiple-systems/quantum-information.ipynb"
---
{/* doqumentation-source-hash: 8874034f */}

<OpenInLabBanner notebookPath="learning/courses/basics-of-quantum-information/multiple-systems/quantum-information.ipynb" />



{/* cspell:ignore Biggr, operatorname */}
Тепер ми готові перейти до квантової інформації в контексті кількох систем.
Подібно до попереднього уроку про поодинокі системи, математичний опис квантової інформації для кількох систем дуже схожий на імовірнісний випадок і використовує подібні концепції та методи.

## Квантові стани {#quantum-states}

Кілька систем можна розглядати колективно як одну складену систему.
Ми вже спостерігали це в імовірнісному контексті, і квантовий контекст є аналогічним.
Тому квантові стани кількох систем представляються векторами-стовпцями з комплексними числами та евклідовою нормою, що дорівнює $1,$ так само, як і квантові стани поодиноких систем.
У випадку кількох систем елементи цих векторів встановлюються у відповідність до *декартового добутку* класичних множин станів, пов'язаних з кожною з окремих систем, оскільки це класична множина станів складеної системи.

Наприклад, якщо $\mathsf{X}$ і $\mathsf{Y}$ є кубітами, то класичною множиною станів пари кубітів $(\mathsf{X},\mathsf{Y}),$ розглянутої колективно як одна система, є декартовий добуток $\{0,1\}\times\{0,1\}.$
Представляючи пари бінарних значень у вигляді бінарних рядків довжини два, ми асоціюємо цю множину декартового добутку з множиною $\{00,01,10,11\}.$
Тому всі наступні вектори є прикладами векторів квантових станів пари $(\mathsf{X},\mathsf{Y}):$

$$
  \frac{1}{\sqrt{2}} \vert 00 \rangle
  - \frac{1}{\sqrt{6}} \vert 01\rangle
  + \frac{i}{\sqrt{6}} \vert 10\rangle
  + \frac{1}{\sqrt{6}} \vert 11\rangle, \quad
  \frac{3}{5} \vert 00\rangle - \frac{4}{5} \vert 11\rangle,
  \quad \text{і} \quad
  \vert 01 \rangle.
$$

Існують варіанти того, як виражаються вектори квантових станів кількох систем, і ми можемо обрати будь-який варіант, що відповідає нашим уподобанням.
Ось кілька прикладів для першого вектора квантового стану, наведеного вище.

1. Ми можемо використовувати той факт, що $\vert ab\rangle = \vert a\rangle \vert b\rangle$ (для будь-яких класичних станів $a$ і $b$), щоб натомість записати
    $$
    \frac{1}{\sqrt{2}} \vert 0\rangle\vert 0 \rangle
    - \frac{1}{\sqrt{6}} \vert 0\rangle\vert 1\rangle
    + \frac{i}{\sqrt{6}} \vert 1\rangle\vert 0\rangle
    + \frac{1}{\sqrt{6}} \vert 1\rangle\vert 1\rangle.
    $$

2. Ми можемо вибрати явно писати символ тензорного добутку ось так:
    $$
    \frac{1}{\sqrt{2}} \vert 0\rangle\otimes\vert 0 \rangle
    - \frac{1}{\sqrt{6}} \vert 0\rangle\otimes\vert 1\rangle
    + \frac{i}{\sqrt{6}} \vert 1\rangle\otimes\vert 0\rangle
    + \frac{1}{\sqrt{6}} \vert 1\rangle\otimes\vert 1\rangle.
    $$

3. Ми можемо додати індекси до кетів, щоб вказати, як вони відповідають системам, що розглядаються, ось так:
    $$
    \frac{1}{\sqrt{2}} \vert 0\rangle_{\mathsf{X}}\vert 0 \rangle_{\mathsf{Y}}
    - \frac{1}{\sqrt{6}} \vert 0\rangle_{\mathsf{X}}\vert 1\rangle_{\mathsf{Y}}
    + \frac{i}{\sqrt{6}} \vert 1\rangle_{\mathsf{X}}\vert 0\rangle_{\mathsf{Y}}
    + \frac{1}{\sqrt{6}} \vert 1\rangle_{\mathsf{X}}\vert 1\rangle_{\mathsf{Y}}.
    $$

Звичайно, ми також можемо явно записувати вектори квантових станів як вектори-стовпці:

$$
  \begin{pmatrix}
  \frac{1}{\sqrt{2}}\\[2mm]
  - \frac{1}{\sqrt{6}}\\[2mm]
  \frac{i}{\sqrt{6}}\\[2mm]
  \frac{1}{\sqrt{6}}
  \end{pmatrix}.
$$

Залежно від контексту, в якому це з'являється, один із цих варіантів може бути бажаним — але всі вони еквівалентні в тому сенсі, що вони описують той самий вектор.

### Тензорні добутки векторів квантових станів {#tensor-products-of-quantum-state-vectors}

Подібно до того, що ми маємо для векторів імовірностей, тензорні добутки векторів квантових станів також є векторами квантових станів — і знову вони представляють *незалежність* між системами.

Детальніше, починаючи з випадку двох систем, припустимо, що $\vert \phi \rangle$ є вектором квантового стану системи $\mathsf{X}$, а $\vert \psi \rangle$ є вектором квантового стану системи $\mathsf{Y}.$
Тоді тензорний добуток $\vert \phi \rangle \otimes \vert \psi \rangle,$ який можна також записати як
$\vert \phi \rangle \vert \psi \rangle$ або як $\vert \phi \otimes \psi \rangle,$ є вектором квантового стану спільної системи $(\mathsf{X},\mathsf{Y}).$
Знову ми називаємо стан такої форми *добутковим станом*.

Інтуїтивно кажучи, коли пара систем $(\mathsf{X},\mathsf{Y})$ перебуває в добутковому стані $\vert \phi \rangle \otimes \vert \psi \rangle,$ ми можемо інтерпретувати це як те, що $\mathsf{X}$ перебуває в квантовому стані $\vert \phi \rangle,$ $\mathsf{Y}$ перебуває в квантовому стані $\vert \psi \rangle,$ і стани двох систем не мають нічого спільного один з одним.

Той факт, що вектор тензорного добутку $\vert \phi \rangle \otimes \vert \psi \rangle$ дійсно є вектором квантового стану, узгоджується з тим, що евклідова норма є *мультиплікативною* відносно тензорних добутків:

$$
\begin{aligned}
  \bigl\| \vert \phi \rangle \otimes \vert \psi \rangle \bigr\|
  & = \sqrt{
    \sum_{(a,b)\in\Sigma\times\Gamma}
    \bigl\vert\langle ab \vert \phi\otimes\psi \rangle \bigr\vert^2
  }\\[1mm]
  & = \sqrt{
    \sum_{a\in\Sigma} \sum_{b\in\Gamma}
    \bigl\vert\langle a \vert \phi \rangle
    \langle b \vert \psi \rangle \bigr\vert^2
  }\\[1mm]
  & = \sqrt{
    \biggl(\sum_{a\in\Sigma}
    \bigl\vert \langle a \vert \phi \rangle \bigr\vert^2
    \biggr)
    \biggl(\sum_{b\in\Gamma}
    \bigl\vert \langle b \vert \psi \rangle \bigr\vert^2
    \biggr)
  }\\[1mm]
  & = \bigl\|
    \vert \phi \rangle \bigr\| \bigl\| \vert \psi \rangle
  \bigr\|.
\end{aligned}
$$

Оскільки $\vert \phi \rangle$ і $\vert \psi \rangle$ є векторами квантових станів, ми маємо $\|\vert \phi \rangle\| = 1$ і $\|\vert \psi \rangle\| = 1,$ і тому $\|\vert \phi \rangle \otimes \vert \psi \rangle\| = 1,$ тож $\vert \phi \rangle \otimes \vert \psi \rangle$ також є вектором квантового стану.

Це узагальнюється на більше ніж дві системи.
Якщо $\vert \psi_0 \rangle,\ldots,\vert \psi_{n-1} \rangle$ є векторами квантових станів систем $\mathsf{X}_0,\ldots,\mathsf{X}_{n-1},$ то $\vert \psi_{n-1} \rangle\otimes\cdots\otimes \vert \psi_0 \rangle$ є вектором квантового стану, що представляє *добутковий стан* спільної системи $(\mathsf{X}_{n-1},\ldots,\mathsf{X}_0).$
Знову ми знаємо, що це вектор квантового стану, тому що

$$
  \bigl\|
  \vert \psi_{n-1} \rangle\otimes\cdots\otimes \vert \psi_0 \rangle
  \bigr\|
  = \bigl\|\vert \psi_{n-1} \rangle\bigl\| \cdots
  \bigl\|\vert \psi_0 \rangle \bigr\| = 1^n = 1.
$$

### Заплутані стани {#entangled-states}

Не всі вектори квантових станів кількох систем є добутковими станами.
Наприклад, вектор квантового стану

$$
  \frac{1}{\sqrt{2}} \vert 00\rangle + \frac{1}{\sqrt{2}} \vert 11\rangle
  \tag{1}
$$

двох кубітів не є добутковим станом.
Щоб обґрунтувати це, ми можемо дотримуватись точно такого ж аргументу, який ми використовували в попередньому розділі для імовірнісного стану.
Тобто, якби $(1)$ був добутковим станом, існували б вектори квантових станів $\vert\phi\rangle$ і $\vert\psi\rangle$, для яких

$$
  \vert\phi\rangle\otimes\vert\psi\rangle
  = \frac{1}{\sqrt{2}} \vert 00\rangle
  + \frac{1}{\sqrt{2}} \vert 11\rangle.
$$

Але тоді обов'язково виконувалося б

$$
  \langle 0 \vert \phi\rangle
  \langle 1 \vert \psi\rangle
  = \langle 01 \vert \phi\otimes\psi\rangle
  = 0
$$

що означає, що $\langle 0 \vert \phi\rangle = 0$ або
$\langle 1 \vert \psi\rangle = 0$ (або обидва).
Це суперечить тому факту, що

$$
  \langle 0 \vert \phi\rangle \langle 0 \vert \psi\rangle
  = \langle 00 \vert \phi\otimes\psi\rangle
  = \frac{1}{\sqrt{2}}
$$

і

$$
  \langle 1 \vert \phi\rangle \langle 1 \vert \psi\rangle
  = \langle 11 \vert \phi\otimes\psi\rangle
  = \frac{1}{\sqrt{2}}
$$

обидва є ненульовими.
Отже, вектор квантового стану $(1)$ представляє *кореляцію* між двома системами, і конкретно ми говоримо, що системи є *заплутаними*.

Зауважте, що конкретне значення $1/\sqrt{2}$ не є важливим для цього аргументу — важливо лише, що це значення є ненульовим.
Тому, наприклад, квантовий стан

$$
  \frac{3}{5} \vert 00\rangle + \frac{4}{5} \vert 11\rangle
$$

також не є добутковим станом за тим самим аргументом.

Заплутаність є квінтесенційною властивістю квантової інформації, яка буде обговорена детальніше в наступному уроці.
Заплутаність може бути складною, особливо для типів шумних квантових станів, які можна описати матрицями густини (які обговорюються в курсі *Загальна формулювання квантової інформації*, який є третім курсом у серії *Розуміння квантової інформації та обчислень*).
Однак для векторів квантових станів заплутаність еквівалентна кореляції: будь-який вектор квантового стану, який не є добутковим станом, представляє заплутаний стан.

Навпаки, вектор квантового стану

$$
   \frac{1}{2} \vert 00\rangle
 + \frac{i}{2} \vert 01\rangle
 - \frac{1}{2} \vert 10\rangle
 - \frac{i}{2} \vert 11\rangle
$$

є прикладом добуткового стану.

$$
  \frac{1}{2} \vert 00\rangle
  + \frac{i}{2} \vert 01\rangle
  - \frac{1}{2} \vert 10\rangle
  - \frac{i}{2} \vert 11\rangle
  =
  \biggl(
    \frac{1}{\sqrt{2}}\vert 0\rangle - \frac{1}{\sqrt{2}}\vert 1\rangle
  \biggr)
  \otimes
  \biggl(
    \frac{1}{\sqrt{2}}\vert 0\rangle + \frac{i}{\sqrt{2}}\vert 1\rangle
  \biggr)
$$

Отже, цей стан не є заплутаним.

### Стани Белла {#bell-states}

Тепер ми розглянемо кілька важливих прикладів квантових станів з кількох кубітів, починаючи зі *станів Белла*.
Це наступні чотири стани двох кубітів:

$$
\begin{aligned}
  \vert \phi^+ \rangle & = \frac{1}{\sqrt{2}} \vert 00 \rangle + \frac{1}{\sqrt{2}} \vert 11 \rangle \\[3mm]
  \vert \phi^- \rangle & = \frac{1}{\sqrt{2}} \vert 00 \rangle - \frac{1}{\sqrt{2}} \vert 11 \rangle \\[3mm]
  \vert \psi^+ \rangle & = \frac{1}{\sqrt{2}} \vert 01 \rangle + \frac{1}{\sqrt{2}} \vert 10 \rangle \\[3mm]
  \vert \psi^- \rangle & = \frac{1}{\sqrt{2}} \vert 01 \rangle - \frac{1}{\sqrt{2}} \vert 10 \rangle
\end{aligned}
$$

Стани Белла названі так на честь <DefinitionTooltip definition="Джон Стюарт Белл (1928—1990) був фізиком, який зробив важливий внесок у основи квантової теорії">Джона Белла</DefinitionTooltip>.
Зауважте, що той самий аргумент, який встановлює, що $\vert\phi^+\rangle$ не є добутковим станом, показує, що жоден з інших станів Белла також не є добутковим станом: всі чотири стани Белла представляють заплутаність між двома кубітами.

Колекція всіх чотирьох станів Белла

$$
  \bigl\{\vert \phi^+ \rangle, \vert \phi^- \rangle, \vert \psi^+ \rangle, \vert \psi^- \rangle\bigr\}
$$

відома як *базис Белла.*
Відповідно до своєї назви, це базис; будь-який вектор квантового стану двох кубітів, або насправді будь-який комплексний вектор взагалі з елементами, що відповідають чотирьом класичним станам двох бітів, може бути виражений як лінійна комбінація чотирьох станів Белла.
Наприклад,

$$
  \vert 0 0 \rangle
  = \frac{1}{\sqrt{2}} \vert \phi^+\rangle
  + \frac{1}{\sqrt{2}} \vert \phi^-\rangle.
$$

### Стани GHZ і W {#ghz-and-w-states}

Далі ми розглянемо два цікаві приклади станів трьох кубітів.
Першим прикладом є *стан GHZ* (названий так на честь Деніела Грінбергера, Майкла Горна та Антона Цайлінгера, які вперше вивчили деякі з його властивостей):

$$
  \frac{1}{\sqrt{2}} \vert 000\rangle +
  \frac{1}{\sqrt{2}} \vert 111\rangle.
$$

Другим прикладом є так званий стан W:

$$
  \frac{1}{\sqrt{3}} \vert 001\rangle +
  \frac{1}{\sqrt{3}} \vert 010\rangle +
  \frac{1}{\sqrt{3}} \vert 100\rangle.
$$

Жоден з цих станів не є добутковим станом, що означає, що вони не можуть бути записані як тензорний добуток трьох векторів квантових станів кубітів.
Ми розглянемо обидва ці стани пізніше, коли будемо обговорювати часткові вимірювання квантових станів кількох систем.

### Додаткові приклади {#additional-examples}

Приклади квантових станів кількох систем, які ми бачили досі, є станами двох або трьох кубітів, але ми також можемо розглядати квантові стани кількох систем з різними класичними множинами станів.

Наприклад, ось квантовий стан трьох систем, $\mathsf{X},$ $\mathsf{Y},$ і $\mathsf{Z},$ де класичною множиною станів $\mathsf{X}$ є бінарний алфавіт (тож $\mathsf{X}$ є кубітом), а класичною множиною станів $\mathsf{Y}$ і $\mathsf{Z}$ є $\{\clubsuit,\diamondsuit,\heartsuit,\spadesuit\}:$

$$
  \frac{1}{2} \vert 0 \rangle \vert \heartsuit\rangle
  \vert \heartsuit \rangle
  + \frac{1}{2} \vert 1 \rangle \vert \spadesuit\rangle
  \vert \heartsuit \rangle
  - \frac{1}{\sqrt{2}} \vert 0 \rangle \vert \heartsuit\rangle
  \vert \diamondsuit \rangle.
$$

А ось приклад квантового стану трьох систем, $\mathsf{X},$ $\mathsf{Y},$ і $\mathsf{Z},$ які всі мають однакову класичну множину станів $\{0,1,2\}:$

$$
  \frac{
    \vert 012 \rangle
    - \vert 021 \rangle
    + \vert 120 \rangle
    - \vert 102 \rangle
    + \vert 201 \rangle
    - \vert 210 \rangle
  }{\sqrt{6}}.
$$

Системи з класичною множиною станів $\{0,1,2\}$ часто називають *тритами* або (припускаючи, що вони можуть перебувати в квантовому стані) *кутритами*.
Термін *кудит* відноситься до системи з класичною множиною станів $\{0,\ldots,d-1\}$ для довільного вибору $d.$

## Вимірювання квантових станів {#measurements-of-quantum-states}

Вимірювання в стандартному базисі квантових станів поодиноких систем обговорювалися в попередньому уроці: якщо система з класичною множиною станів $\Sigma$ перебуває в квантовому стані, представленому вектором $\vert \psi \rangle,$ і ця система вимірюється (відносно вимірювання в стандартному базисі), то кожен класичний стан $a\in\Sigma$ з'являється з імовірністю $\vert \langle a \vert \psi \rangle\vert^2.$
Це говорить нам, що відбувається, коли ми маємо квантовий стан кількох систем і вибираємо вимірювати всю складену систему, що еквівалентно вимірюванню *всіх* систем.

Щоб сформулювати це точно, припустимо, що $\mathsf{X}_0,\ldots,\mathsf{X}_{n-1}$ є системами з класичними множинами станів $\Sigma_0,\ldots,\Sigma_{n-1},$ відповідно.
Тоді ми можемо розглядати $(\mathsf{X}_{n-1},\ldots,\mathsf{X}_0)$ колективно як одну систему, класичною множиною станів якої є декартовий добуток $\Sigma_{n-1}\times\cdots\times\Sigma_0.$
Якщо квантовий стан цієї системи представлений вектором квантового стану $\vert\psi\rangle,$ і всі системи вимірюються, то кожен можливий результат $(a_{n-1},\ldots,a_0)\in\Sigma_{n-1}\times\cdots\times\Sigma_0$ з'являється з імовірністю $\vert\langle a_{n-1}\cdots a_0\vert \psi\rangle\vert^2.$

Наприклад, якщо системи $\mathsf{X}$ і $\mathsf{Y}$ спільно перебувають у квантовому стані

$$
\frac{3}{5} \vert 0\rangle \vert \heartsuit \rangle
- \frac{4i}{5} \vert 1\rangle \vert \spadesuit \rangle,
$$

то вимірювання обох систем вимірюваннями в стандартному базисі дає результат $(0,\heartsuit)$ з імовірністю $9/25$ і результат $(1,\spadesuit)$ з імовірністю $16/25.$

### Часткові вимірювання {#partial-measurements}

Тепер розглянемо ситуацію, в якій ми маємо кілька систем у деякому квантовому стані, і ми вимірюємо власну підмножину систем.
Як і раніше, ми почнемо з двох систем $\mathsf{X}$ і $\mathsf{Y}$ з класичними множинами станів $\Sigma$ і $\Gamma,$ відповідно.

Загалом, вектор квантового стану $(\mathsf{X},\mathsf{Y})$ має вигляд

$$
  \vert \psi \rangle
  = \sum_{(a,b)\in\Sigma\times\Gamma} \alpha_{ab} \vert ab\rangle,
$$

де $\{\alpha_{ab} : (a,b)\in\Sigma\times\Gamma\}$ є колекцією комплексних чисел, що задовольняють

$$
  \sum_{(a,b)\in\Sigma\times\Gamma} \vert \alpha_{ab} \vert^2 = 1,
$$

що еквівалентно тому, що $\vert \psi \rangle$ є одиничним вектором.

Ми вже знаємо з обговорення вище, що якщо і $\mathsf{X}$, і $\mathsf{Y}$ вимірюються, то кожен можливий результат $(a,b)\in\Sigma\times\Gamma$ з'являється з імовірністю

$$
  \bigl\vert \langle ab \vert \psi \rangle \bigr\vert^2 = \vert\alpha_{ab}\vert^2.
$$

Якщо ми натомість припустимо, що вимірюється лише перша система $\mathsf{X}$, то імовірність для кожного результату $a\in\Sigma$ з'явитися повинна бути рівною

$$
  \sum_{b\in\Gamma} \bigl\vert \langle ab \vert \psi \rangle \bigr\vert^{2} = \sum_{b\in\Gamma} \vert\alpha_{ab}\vert^2.
$$

Це узгоджується з тим, що ми вже бачили в імовірнісному контексті, а також з нашим поточним розумінням фізики:
імовірність для кожного результату з'явитися, коли $\mathsf{X}$ вимірюється, не може залежати від того, чи вимірювалася також $\mathsf{Y}$, оскільки це дозволило б комунікацію швидше за світло.

Отримавши конкретний результат $a\in\Sigma$ вимірювання в стандартному базисі $\mathsf{X},$ ми природно очікуємо, що квантовий стан $\mathsf{X}$ змінюється так, що він дорівнює $\vert a\rangle,$ так само, як ми мали для поодиноких систем.
Але що відбувається з квантовим станом $\mathsf{Y}$?

Щоб відповісти на це питання, ми спочатку можемо виразити вектор $\vert\psi\rangle$ як

$$
  \vert\psi\rangle
  = \sum_{a\in\Sigma}
  \vert a \rangle
  \otimes \vert \phi_a \rangle,
$$

де

$$
  \vert \phi_a \rangle = \sum_{b\in\Gamma} \alpha_{ab} \vert b\rangle
$$

для кожного $a\in\Sigma.$
Тут ми дотримуємось тієї самої методології, що й у імовірнісному випадку, виділяючи стани стандартного базису системи, що вимірюється.
Імовірність того, що вимірювання в стандартному базисі $\mathsf{X}$ дає кожен результат $a$, є такою:

$$
  \sum_{b\in\Gamma} \vert\alpha_{ab}\vert^2 = \bigl\| \vert \phi_a \rangle \bigr\|^2.
$$

І в результаті того, що вимірювання в стандартному базисі $\mathsf{X}$ дало результат $a,$ квантовий стан пари $(\mathsf{X},\mathsf{Y})$ разом стає

$$
  \vert a \rangle \otimes \frac{\vert \phi_a \rangle}{\|\vert \phi_a \rangle\|}.
$$

Тобто стан "колапсує", як у випадку однієї системи, але лише настільки, наскільки потрібно, щоб стан був узгоджений з тим, що вимірювання $\mathsf{X}$ дало результат $a.$

Неформально кажучи, $\vert a \rangle \otimes \vert \phi_a\rangle$ представляє компоненту $\vert \psi\rangle$, яка узгоджується з тим, що вимірювання $\mathsf{X}$ призвело до результату $a.$
Тоді ми *нормалізуємо* цей вектор — ділячи його на його евклідову норму, яка дорівнює $\|\vert\phi_a\rangle\|$ — щоб отримати дійсний вектор квантового стану з евклідовою нормою, що дорівнює $1.$
Цей крок нормалізації є аналогічним до того, що ми робили в імовірнісному контексті, коли ми ділили вектори на суму їхніх елементів, щоб отримати вектор імовірності.

Як приклад, розглянемо стан двох кубітів $(\mathsf{X},\mathsf{Y})$ з початку розділу:

$$
  \vert \psi \rangle
  = \frac{1}{\sqrt{2}} \vert 00 \rangle
  - \frac{1}{\sqrt{6}} \vert 01 \rangle
  + \frac{i}{\sqrt{6}} \vert 10 \rangle
  + \frac{1}{\sqrt{6}} \vert 11 \rangle.
$$

Щоб зрозуміти, що відбувається, коли вимірюється перша система $\mathsf{X}$, ми починаємо з запису

$$
  \vert \psi \rangle
  = \vert 0 \rangle \otimes \biggl(
    \frac{1}{\sqrt{2}}  \vert 0 \rangle
    - \frac{1}{\sqrt{6}} \vert 1 \rangle \biggr)
    + \vert 1 \rangle \otimes \biggl(
    \frac{i}{\sqrt{6}} \vert 0 \rangle
    + \frac{1}{\sqrt{6}} \vert 1 \rangle \biggr).
$$

Тепер ми бачимо на основі наведеного вище опису, що імовірність того, що вимірювання призведе до результату $0$, становить

$$
  \biggl\|\frac{1}{\sqrt{2}}  \vert 0 \rangle
  -\frac{1}{\sqrt{6}} \vert 1 \rangle\biggr\|^2
  = \frac{1}{2} + \frac{1}{6}
  = \frac{2}{3},
$$

в якому випадку стан $(\mathsf{X},\mathsf{Y})$ стає

$$
  \vert 0\rangle \otimes
  \frac{\frac{1}{\sqrt{2}} \vert 0 \rangle
  -\frac{1}{\sqrt{6}} \vert 1 \rangle}{\sqrt{\frac{2}{3}}}
  = \vert 0\rangle \otimes
  \Biggl( \frac{\sqrt{3}}{2} \vert 0 \rangle - \frac{1}{2} \vert 1\rangle\Biggr);
$$

і імовірність того, що вимірювання призведе до результату $1$, становить

$$
  \biggl\|\frac{i}{\sqrt{6}}  \vert 0 \rangle
  + \frac{1}{\sqrt{6}} \vert 1 \rangle\biggr\|^2
  = \frac{1}{6} + \frac{1}{6}
  = \frac{1}{3},
$$

в якому випадку стан $(\mathsf{X},\mathsf{Y})$ стає

$$
  \vert 1\rangle \otimes
  \frac{\frac{i}{\sqrt{6}} \vert 0 \rangle
  +\frac{1}{\sqrt{6}} \vert 1 \rangle}{\sqrt{\frac{1}{3}}}
  = \vert 1\rangle \otimes
  \Biggl( \frac{i}{\sqrt{2}} \vert 0 \rangle
  +\frac{1}{\sqrt{2}} \vert 1\rangle\Biggr).
$$

Той самий метод, використаний симетричним чином, описує, що відбувається, якщо вимірюється друга система $\mathsf{Y}$, а не перша.
Цього разу ми переписуємо вектор $\vert \psi \rangle$ як

$$
  \vert \psi \rangle
  = \biggl(
    \frac{1}{\sqrt{2}} \vert 0 \rangle
    + \frac{i}{\sqrt{6}} \vert 1 \rangle
  \biggr) \otimes \vert 0\rangle
  + \biggl(
    -\frac{1}{\sqrt{6}} \vert 0 \rangle
    +\frac{1}{\sqrt{6}} \vert 1\rangle
  \biggr) \otimes \vert 1\rangle.
$$

Імовірність того, що вимірювання $\mathsf{Y}$ дає результат $0$, становить

$$
\biggl\| \frac{1}{\sqrt{2}} \vert 0 \rangle
    + \frac{i}{\sqrt{6}} \vert 1 \rangle \biggr\|^2
= \frac{1}{2} + \frac{1}{6} = \frac{2}{3},
$$

в якому випадку стан $(\mathsf{X},\mathsf{Y})$ стає

$$
  \frac{\frac{1}{\sqrt{2}} \vert 0 \rangle
    + \frac{i}{\sqrt{6}} \vert 1 \rangle}{\sqrt{\frac{2}{3}}} \otimes \vert 0 \rangle
  = \biggl(\frac{\sqrt{3}}{2} \vert 0 \rangle + \frac{i}{2} \vert 1 \rangle\biggr) \otimes\vert 0 \rangle;
$$

і імовірність того, що результат вимірювання є $1$, становить

$$
  \biggl\|
    -\frac{1}{\sqrt{6}} \vert 0 \rangle
    +\frac{1}{\sqrt{6}} \vert 1\rangle
  \biggr\|^2
  = \frac{1}{6} + \frac{1}{6} = \frac{1}{3},
$$

в якому випадку стан $(\mathsf{X},\mathsf{Y})$ стає

$$
\frac{
  -\frac{1}{\sqrt{6}} \vert 0 \rangle
    +\frac{1}{\sqrt{6}} \vert 1\rangle }{\frac{1}{\sqrt{3}}}
  \otimes \vert 1\rangle
  = \biggl(-\frac{1}{\sqrt{2}} \vert 0\rangle
  + \frac{1}{\sqrt{2}} \vert 1\rangle\biggr) \otimes \vert 1\rangle.
$$

### Зауваження про редуковані квантові стани {#remark-on-reduced-quantum-states}

Попередній приклад показує обмеження спрощеного опису квантової інформації, яке полягає в тому, що він не пропонує нам способу описати редукований (або маргінальний) квантовий стан лише однієї з двох систем (або власної підмножини будь-якої кількості систем), як у імовірнісному випадку.

Конкретно, для імовірнісного стану двох систем $(\mathsf{X},\mathsf{Y})$, описаного вектором імовірності

$$
  \sum_{(a,b)\in\Sigma\times\Gamma} p_{ab} \vert ab\rangle,
$$

ми можемо записати *редукований* або *маргінальний* імовірнісний стан лише $\mathsf{X}$ як

$$
  \sum_{a\in\Sigma} \biggl( \sum_{b\in\Gamma} p_{ab}\biggr) \vert a\rangle =
  \sum_{(a,b)\in\Sigma\times\Gamma} p_{ab} \vert a\rangle.
$$

Для векторів квантових станів немає аналогічного способу зробити це.
Зокрема, для вектора квантового стану

$$
  \vert \psi \rangle = \sum_{(a,b)\in\Sigma\times\Gamma} \alpha_{ab} \vert ab\rangle,
$$

вектор

$$
  \sum_{(a,b)\in\Sigma\times\Gamma} \alpha_{ab} \vert a\rangle
$$

не є вектором квантового стану загалом і не представляє належним чином концепцію редукованого або маргінального стану.

Замість цього ми можемо звернутися до поняття *матриці густини,* яка обговорюється в курсі *Загальна формулювання квантової інформації*.
Матриці густини надають нам змістовний спосіб визначити редуковані квантові стани, який є аналогічним до імовірнісного контексту.

### Часткові вимірювання для трьох або більше систем {#partial-measurements-for-three-or-more-systems}

Часткові вимірювання для трьох або більше систем, де вимірюється деяка власна підмножина систем, можуть бути зведені до випадку двох систем шляхом розділення систем на дві колекції: ті, що вимірюються, і ті, що не вимірюються.
Ось конкретний приклад, який ілюструє, як це можна зробити.
Він демонструє конкретно, як індексація кетів іменами систем, які вони представляють, може бути корисною — в цьому випадку тому, що це дає нам простий спосіб описати перестановки систем.

Для цього прикладу ми розглянемо квантовий стан п'ятірки систем $(\mathsf{X}_4,\ldots,\mathsf{X}_0),$ де всі п'ять цих систем мають однакову класичну множину станів $\{\clubsuit,\diamondsuit,\heartsuit,\spadesuit\}:$

$$
\begin{gathered}
\sqrt{\frac{1}{7}}
\vert\heartsuit\rangle \vert\clubsuit\rangle \vert\diamondsuit\rangle \vert\spadesuit\rangle \vert\spadesuit\rangle
+ \sqrt{\frac{2}{7}}
\vert\diamondsuit\rangle \vert\clubsuit\rangle \vert\diamondsuit\rangle \vert\spadesuit\rangle \vert\clubsuit\rangle
+ \sqrt{\frac{1}{7}}
\vert\spadesuit\rangle \vert\spadesuit\rangle \vert\clubsuit\rangle \vert\diamondsuit\rangle \vert\clubsuit\rangle \\
-i \sqrt{\frac{2}{7}}
\vert\heartsuit\rangle \vert\clubsuit\rangle \vert\diamondsuit\rangle \vert\heartsuit\rangle \vert\heartsuit\rangle
- \sqrt{\frac{1}{7}}
\vert\spadesuit\rangle \vert\heartsuit\rangle \vert\clubsuit\rangle \vert\spadesuit\rangle \vert\clubsuit\rangle.
\end{gathered}
$$

Ми розглянемо ситуацію, в якій вимірюються перша і третя системи, а решта систем залишається без змін.

Концептуально кажучи, немає фундаментальної різниці між цією ситуацією та тією, в якій вимірюється одна з двох систем.
На жаль, оскільки вимірювані системи перемежовані з невимірюваними системами, ми стикаємось з перешкодою при записі виразів, необхідних для виконання цих обчислень.

Один спосіб продовжити, як зазначено вище, полягає в індексації кетів, щоб вказати, на які системи вони посилаються.
Це дає нам спосіб відстежувати системи, коли ми переставляємо порядок кетів, що робить математику простішою.

По-перше, вектор квантового стану, наведений вище, можна альтернативно записати як

$$
\begin{gathered}
\sqrt{\frac{1}{7}}
\vert\heartsuit\rangle_4 \vert\clubsuit\rangle_3 \vert\diamondsuit\rangle_2 \vert\spadesuit\rangle_1 \vert\spadesuit\rangle_0
+ \sqrt{\frac{2}{7}}
\vert\diamondsuit\rangle_4 \vert\clubsuit\rangle_3 \vert\diamondsuit\rangle_2 \vert\spadesuit\rangle_1 \vert\clubsuit\rangle_0\\
+ \sqrt{\frac{1}{7}}
\vert\spadesuit\rangle_4 \vert\spadesuit\rangle_3 \vert\clubsuit\rangle_2 \vert\diamondsuit\rangle_1 \vert\clubsuit\rangle_0
-i \sqrt{\frac{2}{7}}
\vert\heartsuit\rangle_4 \vert\clubsuit\rangle_3 \vert\diamondsuit\rangle_2 \vert\heartsuit\rangle_1 \vert\heartsuit\rangle_0\\
- \sqrt{\frac{1}{7}}
\vert\spadesuit\rangle_4 \vert\heartsuit\rangle_3 \vert\clubsuit\rangle_2 \vert\spadesuit\rangle_1 \vert\clubsuit\rangle_0.
\end{gathered}
$$

Нічого не змінилося, крім того, що кожен кет тепер має індекс, що вказує, якій системі він відповідає.
Тут ми використали індекси $0,\ldots,4,$ але також можна використовувати імена самих систем (у ситуації, коли ми маємо імена систем, такі як $\mathsf{X},$ $\mathsf{Y},$ і $\mathsf{Z},$ наприклад).

Тепер ми можемо переупорядкувати кети і згрупувати терми наступним чином:

$$
\begin{aligned}
&
\sqrt{\frac{1}{7}}
\vert\heartsuit\rangle_4 \vert\diamondsuit\rangle_2 \vert\clubsuit\rangle_3 \vert\spadesuit\rangle_1 \vert\spadesuit\rangle_0
+
\sqrt{\frac{2}{7}}
\vert\diamondsuit\rangle_4 \vert\diamondsuit\rangle_2 \vert\clubsuit\rangle_3 \vert\spadesuit\rangle_1 \vert\clubsuit\rangle_0\\
& \quad +
\sqrt{\frac{1}{7}}
\vert\spadesuit\rangle_4 \vert\clubsuit\rangle_2 \vert\spadesuit\rangle_3 \vert\diamondsuit\rangle_1 \vert\clubsuit\rangle_0
-i
\sqrt{\frac{2}{7}}
\vert\heartsuit\rangle_4 \vert\diamondsuit\rangle_2 \vert\clubsuit\rangle_3 \vert\heartsuit\rangle_1 \vert\heartsuit\rangle_0\\
& \quad -\sqrt{\frac{1}{7}}
\vert\spadesuit\rangle_4 \vert\clubsuit\rangle_2 \vert\heartsuit\rangle_3 \vert\spadesuit\rangle_1 \vert\clubsuit\rangle_0\\[2mm]
& \hspace{1.5cm} = \vert\heartsuit\rangle_4 \vert\diamondsuit\rangle_2
\biggl(
\sqrt{\frac{1}{7}} \vert\clubsuit\rangle_3 \vert\spadesuit\rangle_1 \vert\spadesuit\rangle_0
-i \sqrt{\frac{2}{7}} \vert\clubsuit\rangle_3 \vert\heartsuit\rangle_1 \vert\heartsuit\rangle_0
\biggr)\\
& \hspace{1.5cm} \quad
+ \vert\diamondsuit\rangle_4 \vert\diamondsuit\rangle_2
\biggl(
\sqrt{\frac{2}{7}} \vert\clubsuit\rangle_3 \vert\spadesuit\rangle_1 \vert\clubsuit\rangle_0
\biggr)\\
& \hspace{1.5cm} \quad + \vert\spadesuit\rangle_4 \vert\clubsuit\rangle_2
\biggl(
\sqrt{\frac{1}{7}} \vert\spadesuit\rangle_3 \vert\diamondsuit\rangle_1 \vert\clubsuit\rangle_0
- \sqrt{\frac{1}{7}} \vert\heartsuit\rangle_3 \vert\spadesuit\rangle_1 \vert\clubsuit\rangle_0\biggr).
\end{aligned}
$$

Тензорні добутки все ще є неявними, навіть коли використовуються дужки, як у цьому прикладі.

Щоб бути зрозумілими щодо перестановки кетів, тензорні добутки не є комутативними: якщо $\vert \phi\rangle$ і $\vert \pi \rangle$ є векторами, то загалом $\vert \phi\rangle\otimes\vert \pi \rangle$ відрізняється від $\vert \pi\rangle\otimes\vert \phi \rangle,$ і аналогічно для тензорних добутків трьох або більше векторів.
Наприклад,
$\vert\heartsuit\rangle \vert\clubsuit\rangle \vert\diamondsuit\rangle \vert\spadesuit\rangle \vert\spadesuit\rangle$
є іншим вектором, ніж
$\vert\heartsuit\rangle \vert\diamondsuit\rangle \vert\clubsuit\rangle \vert\spadesuit\rangle \vert\spadesuit\rangle.$
Переупорядкування кетів, яке ми щойно зробили, не слід інтерпретувати як таке, що вказує на інше.

Скоріше, для цілей виконання обчислень ми просто приймаємо рішення, що зручніше групувати системи разом як $(\mathsf{X}_4,\mathsf{X}_2,\mathsf{X}_3,\mathsf{X}_1,\mathsf{X}_0)$, а не як $(\mathsf{X}_4,\mathsf{X}_3,\mathsf{X}_2,\mathsf{X}_1,\mathsf{X}_0).$
Індекси на кетах служать для того, щоб все це було зрозумілим, і ми можемо повернутися до початкового порядку пізніше, якщо захочемо це зробити.

Тепер ми бачимо, що якщо вимірюються системи $\mathsf{X}_4$ і $\mathsf{X}_2$, (ненульові) імовірності різних результатів є такими:

  - Результат вимірювання $(\heartsuit,\diamondsuit)$ виникає з імовірністю

  $$
  \biggl\|
  \sqrt{\frac{1}{7}} \vert\clubsuit\rangle_3 \vert\spadesuit\rangle_1 \vert\spadesuit\rangle_0
  -i \sqrt{\frac{2}{7}} \vert\clubsuit\rangle_3 \vert\heartsuit\rangle_1 \vert\heartsuit\rangle_0
  \biggr\|^2 = \frac{1}{7} + \frac{2}{7} = \frac{3}{7}
  $$

  - Результат вимірювання $(\diamondsuit,\diamondsuit)$ виникає з імовірністю

  $$
  \biggl\|
  \sqrt{\frac{2}{7}} \vert\clubsuit\rangle_3 \vert\spadesuit\rangle_1 \vert\clubsuit\rangle_0
  \biggr\|^2 = \frac{2}{7}
  $$

  - Результат вимірювання $(\spadesuit,\clubsuit)$ виникає з імовірністю

  $$
  \biggl\|
  \sqrt{\frac{1}{7}} \vert\spadesuit\rangle_3 \vert\diamondsuit\rangle_1 \vert\clubsuit\rangle_0
  - \sqrt{\frac{1}{7}} \vert\heartsuit\rangle_3 \vert\spadesuit\rangle_1 \vert\clubsuit\rangle_0
  \biggr\|^2 = \frac{1}{7} + \frac{1}{7} = \frac{2}{7}.
  $$

Якщо результат вимірювання є $(\heartsuit,\diamondsuit),$ наприклад, результуючий стан наших п'яти систем стає

$$
\begin{aligned}
& \vert \heartsuit\rangle_4 \vert \diamondsuit \rangle_2
\otimes
\frac{
\sqrt{\frac{1}{7}}
\vert\clubsuit\rangle_3 \vert\spadesuit\rangle_1 \vert\spadesuit\rangle_0
- i
\sqrt{\frac{2}{7}}
\vert\clubsuit\rangle_3 \vert\heartsuit\rangle_1 \vert\heartsuit\rangle_0}
{\sqrt{\frac{3}{7}}}\\
& \qquad
=
\sqrt{\frac{1}{3}}
\vert \heartsuit\rangle_4 \vert\clubsuit\rangle_3 \vert \diamondsuit \rangle_2\vert\spadesuit\rangle_1 \vert\spadesuit\rangle_0
-i
\sqrt{\frac{2}{3}}
\vert \heartsuit\rangle_4 \vert\clubsuit\rangle_3 \vert \diamondsuit \rangle_2\vert\heartsuit\rangle_1 \vert\heartsuit\rangle_0.
\end{aligned}
$$

Тут для остаточної відповіді ми повернулися до нашого початкового порядку систем, просто щоб проілюструвати, що ми можемо це зробити.
Для інших можливих результатів вимірювання стан можна визначити подібним чином.

Нарешті, ось два приклади, обіцяні раніше, починаючи зі стану GHZ

$$
\frac{1}{\sqrt{2}} \vert 000\rangle + \frac{1}{\sqrt{2}} \vert 111\rangle.
$$

Якщо вимірюється лише перша система, ми отримуємо результат $0$ з імовірністю $1/2,$ в якому випадку стан трьох кубітів стає $\vert 000\rangle;$ і ми також отримуємо результат $1$ з імовірністю $1/2,$ в якому випадку стан трьох кубітів стає $\vert 111\rangle.$

Для стану W, з іншого боку, знову припускаючи, що вимірюється лише перша система, ми починаємо з запису цього стану ось так:

$$
\begin{aligned}
&
\frac{1}{\sqrt{3}} \vert 001\rangle +
\frac{1}{\sqrt{3}} \vert 010\rangle +
\frac{1}{\sqrt{3}} \vert 100\rangle \\
& \qquad
= \vert 0 \rangle \biggl(
\frac{1}{\sqrt{3}} \vert 01\rangle +
\frac{1}{\sqrt{3}} \vert 10\rangle\biggr)
+ \vert 1 \rangle \biggl(\frac{1}{\sqrt{3}}\vert 00\rangle\biggr).
\end{aligned}
$$

Тому імовірність того, що вимірювання першого кубіта призведе до результату 0, дорівнює

$$
\biggl\|
\frac{1}{\sqrt{3}} \vert 01\rangle +
\frac{1}{\sqrt{3}} \vert 10\rangle
\biggr\|^2 = \frac{2}{3},
$$

і за умови, що вимірювання дає цей результат, квантовий стан трьох кубітів стає

$$
\vert 0\rangle\otimes
  \frac{
    \frac{1}{\sqrt{3}} \vert 01\rangle +
    \frac{1}{\sqrt{3}} \vert 10\rangle
  }{
    \sqrt{\frac{2}{3}}
  }
  = \vert 0\rangle \biggl(\frac{1}{\sqrt{2}} \vert 01\rangle
    + \frac{1}{\sqrt{2}} \vert 10\rangle \biggr)
  = \vert 0\rangle\vert \psi^+\rangle.
$$

Імовірність того, що результат вимірювання є 1, становить $1/3,$ в якому випадку стан трьох кубітів стає
$\vert 100\rangle.$

Стан W є симетричним у тому сенсі, що він не змінюється, якщо ми переставляємо кубіти.
Тому ми отримуємо подібний опис для вимірювання другого або третього кубіта замість першого.

## Унітарні операції {#unitary-operations}

В принципі, будь-яка унітарна матриця, рядки і стовпці якої відповідають класичним станам системи, представляє дійсну квантову операцію над цією системою.
Це, звичайно, залишається вірним для складених систем, класичними множинами станів яких є декартові добутки класичних множин станів окремих систем.

Зосереджуючись на двох системах, якщо $\mathsf{X}$ є системою з класичною множиною станів $\Sigma,$ а $\mathsf{Y}$ є системою з класичною множиною станів $\Gamma,$ то класичною множиною станів спільної системи $(\mathsf{X},\mathsf{Y})$ є $\Sigma\times\Gamma.$ Тому квантові операції над цією спільною системою представляються унітарними матрицями, рядки і стовпці яких встановлені у відповідність до множини $\Sigma\times\Gamma.$
Порядок рядків і стовпців цих матриць такий самий, як порядок, що використовується для векторів квантових станів системи $(\mathsf{X},\mathsf{Y}).$

Наприклад, припустимо, що $\Sigma = \{1,2,3\}$ і $\Gamma = \{0,1\},$ і нагадаємо, що стандартною конвенцією для впорядкування елементів декартового добутку $\{1,2,3\}\times\{0,1\}$ є така:

$$
(1,0),\;(1,1),\;(2,0),\;(2,1),\;(3,0),\; (3,1).
$$

Ось приклад унітарної матриці, що представляє операцію над $(\mathsf{X},\mathsf{Y}):$

$$
U =
\begin{pmatrix}
  \frac{1}{2} & \frac{1}{2} & \frac{1}{2} & 0 & 0 & \frac{1}{2} \\[2mm]
  \frac{1}{2} & \frac{i}{2} & -\frac{1}{2} & 0 & 0 & -\frac{i}{2} \\[2mm]
  \frac{1}{2} & -\frac{1}{2} & \frac{1}{2} & 0 & 0 & -\frac{1}{2} \\[2mm]
  0 & 0 & 0 & \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}} & 0\\[2mm]
  \frac{1}{2} & -\frac{i}{2} & -\frac{1}{2} & 0 & 0 & \frac{i}{2} \\[2mm]
  0 & 0 & 0 &  -\frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}} & 0
\end{pmatrix}.
$$

Ця унітарна матриця не є особливою, це просто приклад.
Щоб перевірити, що $U$ є унітарною, достатньо обчислити і перевірити, що $U^{\dagger} U = \mathbb{I},$ наприклад.
Альтернативно, ми можемо перевірити, що рядки (або стовпці) є ортонормальними, що спрощується в цьому випадку, враховуючи конкретну форму матриці $U.$

Дія $U$ на вектор стандартного базису $\vert 1, 1 \rangle,$ наприклад, є

$$
U \vert 1, 1\rangle =
\frac{1}{2} \vert 1, 0 \rangle
+ \frac{i}{2} \vert 1, 1 \rangle
- \frac{1}{2} \vert 2, 0 \rangle
- \frac{i}{2} \vert 3, 0\rangle,
$$

що ми можемо побачити, вивчивши другий стовпець $U,$ враховуючи наше впорядкування множини $\{1,2,3\}\times\{0,1\}.$

Як і з будь-якою матрицею, можна виразити $U$, використовуючи нотацію Дірака, що вимагатиме 20 термів для 20 ненульових елементів $U.$
Однак якби ми записали всі ці терми замість того, щоб писати матрицю $6\times 6$, це було б безладно, і шаблони, які очевидні з матричного виразу, ймовірно, не були б такими зрозумілими.
Простіше кажучи, нотація Дірака не завжди є найкращим вибором.

Унітарні операції над трьома або більше системами працюють подібним чином, причому унітарні матриці мають рядки і стовпці, що відповідають декартовому добутку класичних множин станів систем.
Ми вже бачили один приклад у цьому уроці: операцію над трьома кубітами

$$
\sum_{k = 0}^{7} \vert (k+1) \bmod 8 \rangle \langle k \vert,
$$

де числа в брах і кетах означають їх $3$-бітні бінарні кодування.
Окрім того, що це детерміністична операція, це також унітарна операція.
Операції, які є як детерміністичними, так і унітарними, називаються *оборотними* операціями.
Спряжено-транспоновану цієї матриці можна записати так:

$$
\sum_{k = 0}^{7} \vert k \rangle \langle (k+1) \bmod 8 \vert
= \sum_{k = 0}^{7} \vert (k-1) \bmod 8 \rangle \langle k \vert.
$$

Це представляє *зворотну* операцію, або в математичних термінах *обернену*, до початкової операції — що ми очікуємо від спряжено-транспонованої унітарної матриці.
Ми побачимо інші приклади унітарних операцій над кількома системами по мірі продовження уроку.

### Унітарні операції, виконувані незалежно над окремими системами {#unitary-operations-performed-independently-on-individual-systems}

Коли унітарні операції виконуються незалежно над колекцією окремих систем, комбінована дія цих незалежних операцій описується тензорним добутком унітарних матриць, які їх представляють.
Тобто, якщо $\mathsf{X}_{0},\ldots,\mathsf{X}_{n-1}$ є квантовими системами, $U_0,\ldots, U_{n-1}$ є унітарними матрицями, що представляють операції над цими системами, і операції виконуються незалежно над системами, комбінована дія над $(\mathsf{X}_{n-1},\ldots,\mathsf{X}_0)$ представляється матрицею $U_{n-1}\otimes\cdots\otimes U_0.$
Знову ми виявляємо, що імовірнісний і квантовий контексти є аналогічними в цьому відношенні.

Природно було б очікувати, читаючи попередній абзац, що тензорний добуток будь-якої колекції унітарних матриць є унітарним.
Дійсно, це правда, і ми можемо перевірити це наступним чином.

Зауважте спочатку, що операція спряженого транспонування задовольняє

$$
  (M_{n-1} \otimes \cdots \otimes M_0)^{\dagger} = M_{n-1}^{\dagger} \otimes \cdots \otimes M_0^{\dagger}
$$

для будь-яких вибраних матриць $M_0,\ldots,M_{n-1}.$
Це можна перевірити, повернувшись до визначення тензорного добутку і спряженого транспонування, і перевіривши, що кожен елемент двох сторін рівняння узгоджується.
Це означає, що

$$
 (U_{n-1} \otimes \cdots \otimes U_0)^{\dagger} (U_{n-1}\otimes\cdots\otimes U_0)
 = (U_{n-1}^{\dagger} \otimes \cdots \otimes U_0^{\dagger}) (U_{n-1}\otimes\cdots\otimes U_0).
$$

Оскільки тензорний добуток матриць є мультиплікативним, ми виявляємо, що

$$
  (U_{n-1}^{\dagger} \otimes \cdots \otimes U_0^{\dagger}) (U_{n-1}\otimes\cdots\otimes U_0)
  = (U_{n-1}^{\dagger} U_{n-1}) \otimes \cdots \otimes (U_0^{\dagger} U_0)
  = \mathbb{I}_{n-1} \otimes \cdots \otimes \mathbb{I}_0.
$$

Тут ми написали $\mathbb{I}_0,\ldots,\mathbb{I}_{n-1}$ для позначення матриць, що представляють тотожну операцію над системами $\mathsf{X}_0,\ldots,\mathsf{X}_{n-1},$ що означає, що це одиничні матриці, розміри яких узгоджуються з кількістю класичних станів $\mathsf{X}_0,\ldots,\mathsf{X}_{n-1}.$

Нарешті, тензорний добуток $\mathbb{I}_{n-1} \otimes \cdots \otimes \mathbb{I}_0$ дорівнює одиничній матриці, для якої ми маємо кількість рядків і стовпців, яка узгоджується з добутком кількості рядків і стовпців матриць
$\mathbb{I}_{n-1},\ldots,\mathbb{I}_0.$
Ця більша одинична матриця представляє тотожну операцію над спільною системою $(\mathsf{X}_{n-1},\ldots,\mathsf{X}_0).$

Підсумовуючи, ми маємо наступну послідовність рівностей:

$$
\begin{aligned}
  & (U_{n-1} \otimes \cdots \otimes U_0)^{\dagger} (U_{n-1}\otimes\cdots\otimes U_0) \\
  & \quad = (U_{n-1}^{\dagger} \otimes \cdots \otimes U_0^{\dagger}) (U_{n-1}\otimes\cdots\otimes U_0) \\
  & \quad = (U_{n-1}^{\dagger} U_{n-1}) \otimes \cdots \otimes (U_0^{\dagger} U_0)\\
  & \quad = \mathbb{I}_{n-1} \otimes \cdots \otimes \mathbb{I}_0\\
  & \quad = \mathbb{I}.
\end{aligned}
$$

Тому ми робимо висновок, що $U_{n-1} \otimes \cdots \otimes U_0$ є унітарним.

Важлива ситуація, яка часто виникає, — це та, в якій унітарна операція застосовується лише до однієї системи — або власної підмножини систем — в межах більшої спільної системи.
Наприклад, припустимо, що $\mathsf{X}$ і $\mathsf{Y}$ є системами, які ми можемо розглядати разом як таки, що формують одну, складену систему $(\mathsf{X},\mathsf{Y}),$ і ми виконуємо операцію лише над системою $\mathsf{X}.$
Щоб бути точними, припустимо, що $U$ є унітарною матрицею, що представляє операцію над $\mathsf{X},$ тож її рядки і стовпці встановлені у відповідність до класичних станів $\mathsf{X}.$

Сказати, що ми виконуємо операцію, представлену $U$, лише над системою $\mathsf{X}$, означає, що ми нічого не робимо з $\mathsf{Y},$ що означає, що ми незалежно виконуємо $U$ над $\mathsf{X}$ і *тотожну операцію* над $\mathsf{Y}.$
Тобто "нічого не робити" з $\mathsf{Y}$ еквівалентно виконанню тотожної операції над $\mathsf{Y},$ яка представляється одиничною матрицею $\mathbb{I}_\mathsf{Y}.$
(Тут, до речі, індекс $\mathsf{Y}$ говорить нам, що $\mathbb{I}_\mathsf{Y}$ відноситься до одиничної матриці, що має кількість рядків і стовпців у відповідності з класичною множиною станів $\mathsf{Y}.$)
Тому операція над $(\mathsf{X},\mathsf{Y})$, яка отримується, коли ми виконуємо $U$ над $\mathsf{X}$ і нічого не робимо з $\mathsf{Y}$, представляється унітарною матрицею

$$
  U \otimes \mathbb{I}_{\mathsf{Y}}.
$$

Наприклад, якщо $\mathsf{X}$ і $\mathsf{Y}$ є кубітами, виконання операції Адамара над $\mathsf{X}$ і нічого над $\mathsf{Y}$ еквівалентно виконанню операції

$$
  H \otimes \mathbb{I}_{\mathsf{Y}} =
  \begin{pmatrix}
    \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}}\\[2mm]
    \frac{1}{\sqrt{2}} & -\frac{1}{\sqrt{2}}
  \end{pmatrix}
  \otimes
  \begin{pmatrix}
    1 & 0\\
    0 & 1
  \end{pmatrix}
  = \begin{pmatrix}
    \frac{1}{\sqrt{2}} & 0 & \frac{1}{\sqrt{2}} & 0\\[2mm]
    0 & \frac{1}{\sqrt{2}} & 0 & \frac{1}{\sqrt{2}}\\[2mm]
    \frac{1}{\sqrt{2}} & 0 & -\frac{1}{\sqrt{2}} & 0\\[2mm]
    0 & \frac{1}{\sqrt{2}} & 0 & -\frac{1}{\sqrt{2}}
  \end{pmatrix}
$$

над спільною системою $(\mathsf{X},\mathsf{Y}).$

Подібним чином, якщо операція, представлена унітарною матрицею $U$, застосовується до $\mathsf{Y}$, і нічого не робиться з $\mathsf{X},$ результуюча операція над $(\mathsf{X},\mathsf{Y})$ представляється унітарною матрицею

$$
  \mathbb{I}_{\mathsf{X}} \otimes U.
$$

Наприклад, якщо ми знову розглянемо ситуацію, в якій і $\mathsf{X}$, і $\mathsf{Y}$ є кубітами, і $U$ є операцією Адамара, результуюча операція над $(\mathsf{X},\mathsf{Y})$ представляється матрицею

$$
  \begin{pmatrix}
    1 & 0\\
    0 & 1
  \end{pmatrix}
  \otimes
  \begin{pmatrix}
    \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}}\\[2mm]
    \frac{1}{\sqrt{2}} & -\frac{1}{\sqrt{2}}
  \end{pmatrix}
  = \begin{pmatrix}
    \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}} & 0 & 0\\[2mm]
    \frac{1}{\sqrt{2}} & -\frac{1}{\sqrt{2}} & 0 & 0\\[2mm]
    0 & 0 & \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}}\\[2mm]
    0 & 0 & \frac{1}{\sqrt{2}} & -\frac{1}{\sqrt{2}}
  \end{pmatrix}.
$$

Не кожна унітарна операція над колекцією систем може бути записана як тензорний добуток унітарних операцій ось так, так само як не кожен вектор квантового стану цих систем є добутковим станом.
Наприклад, ні операція обміну, ні операція керованого НЕ над двома кубітами, які описані нижче, не можуть бути виражені як тензорний добуток унітарних операцій.

### Операція обміну {#the-swap-operation}

Завершуючи урок, давайте розглянемо два класи прикладів унітарних операцій над кількома системами, починаючи з *операції обміну*.

Припустимо, що $\mathsf{X}$ і $\mathsf{Y}$ є системами, які мають однакову класичну множину станів $\Sigma.$
Операція *обміну* над парою $(\mathsf{X},\mathsf{Y})$ є операцією, яка обмінює вміст
двох систем, але в іншому залишає системи незмінними — так що $\mathsf{X}$ залишається зліва, а $\mathsf{Y}$
залишається справа.
Ми позначимо цю операцію як $\operatorname{SWAP},$ і вона діє ось так для кожного вибору класичних станів $a,b\in\Sigma:$

$$
\operatorname{SWAP} \vert a \rangle \vert b \rangle = \vert b \rangle \vert a \rangle.
$$

Один спосіб записати матрицю, пов'язану з цією операцією, використовуючи нотацію Дірака, є таким:

$$
\mathrm{SWAP} = \sum_{c,d\in\Sigma} \vert c \rangle \langle d \vert \otimes \vert d \rangle \langle c \vert.
$$

Може бути не одразу зрозуміло, що ця матриця представляє $\operatorname{SWAP},$ але ми можемо перевірити, що вона задовольняє умові
$\operatorname{SWAP} \vert a \rangle \vert b \rangle = \vert b \rangle \vert a \rangle$ для кожного вибору класичних станів $a,b\in\Sigma.$
Як простий приклад, коли $\mathsf{X}$ і $\mathsf{Y}$ є кубітами, ми виявляємо, що

$$
  \operatorname{SWAP} =
  \begin{pmatrix}
  1 & 0 & 0 & 0\\
  0 & 0 & 1 & 0\\
  0 & 1 & 0 & 0\\
  0 & 0 & 0 & 1
  \end{pmatrix}.
$$

### Керовані унітарні операції {#controlled-unitary-operations}

Тепер припустимо, що $\mathsf{Q}$ є кубітом, а $\mathsf{R}$ є довільною системою з будь-якою класичною
множиною станів, яку ми бажаємо.
Для кожної унітарної операції $U$, що діє на систему $\mathsf{R},$ *керована*-$U$ операція є унітарною
операцією над парою $(\mathsf{Q},\mathsf{R})$, визначеною наступним чином:

$$
CU =
\vert 0\rangle \langle 0\vert \otimes \mathbb{I}_{\mathsf{R}} + \vert 1\rangle \langle 1\vert \otimes U.
$$

Наприклад, якщо $\mathsf{R}$ також є кубітом, і ми розглядаємо операцію Паулі $X$ над $\mathrm{R},$
то керована-$X$ операція дається як

$$
  CX =
  \vert 0\rangle \langle 0\vert \otimes \mathbb{I}_{\mathsf{R}} + \vert 1\rangle \langle 1\vert \otimes X =
  \begin{pmatrix}
  1 & 0 & 0 & 0\\
  0 & 1 & 0 & 0\\
  0 & 0 & 0 & 1\\
  0 & 0 & 1 & 0
  \end{pmatrix}.
$$

Ми вже зустрічали цю операцію в контексті класичної інформації та імовірнісних операцій
раніше в уроці.
Заміна операції Паулі $X$ над $\mathsf{R}$ на операцію $Z$ дає цю операцію:

$$
  CZ =
  \vert 0\rangle \langle 0\vert \otimes \mathbb{I}_{\mathsf{R}} + \vert 1\rangle \langle 1\vert \otimes Z =
  \begin{pmatrix}
  1 & 0 & 0 & 0\\
  0 & 1 & 0 & 0\\
  0 & 0 & 1 & 0\\
  0 & 0 & 0 & -1
  \end{pmatrix}.
$$

Якщо натомість ми візьмемо $\mathsf{R}$ як два кубіти, і візьмемо $U$ як *операцію обміну* між цими двома
кубітами, ми отримаємо цю операцію:

$$
  \operatorname{CSWAP} =
  \begin{pmatrix}
  1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
  0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 \\
  0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 \\
  0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 \\
  0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 \\
  0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 \\
  0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 \\
  0 & 0 & 0 & 0 & 0 & 0 & 0 & 1
  \end{pmatrix}.
$$

Ця операція також відома як *операція Фредкіна,* або частіше, *гейт Фредкіна.*
Її дію на стани стандартного базису можна описати наступним чином:

$$
  \begin{aligned}
    \operatorname{CSWAP} \vert 0 b c \rangle
    & = \vert 0 b c \rangle \\[1mm]
    \operatorname{CSWAP} \vert 1 b c \rangle
    & = \vert 1 c b \rangle
  \end{aligned}
$$

Нарешті, *керована-керована-НЕ операція*, яку ми можемо позначити як $CCX,$ називається *операцією Тоффолі* або *гейтом Тоффолі.*
Її матричне представлення виглядає так:

$$
  CCX =
  \begin{pmatrix}
    1 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
    0 & 1 & 0 & 0 & 0 & 0 & 0 & 0\\
    0 & 0 & 1 & 0 & 0 & 0 & 0 & 0\\
    0 & 0 & 0 & 1 & 0 & 0 & 0 & 0\\
    0 & 0 & 0 & 0 & 1 & 0 & 0 & 0\\
    0 & 0 & 0 & 0 & 0 & 1 & 0 & 0\\
    0 & 0 & 0 & 0 & 0 & 0 & 0 & 1\\
    0 & 0 & 0 & 0 & 0 & 0 & 1 & 0
  \end{pmatrix}.
$$

Ми можемо альтернативно виразити її, використовуючи нотацію Дірака, наступним чином:

$$
  CCX = \bigl(
    \vert 00 \rangle \langle 00 \vert
    + \vert 01 \rangle \langle 01 \vert
    + \vert 10 \rangle \langle 10 \vert \bigr) \otimes \mathbb{I}
    + \vert 11 \rangle \langle 11 \vert \otimes X.
$$
