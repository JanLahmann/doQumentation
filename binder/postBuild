#!/bin/bash
set -e
pip install --no-cache-dir --no-compile --quiet \
  qiskit-ibm-catalog \
  qiskit-ibm-transpiler \
  qiskit-addon-cutting \
  pylatexenc
# Cleanup in same layer to actually reduce size
find ${NB_PYTHON_PREFIX}/lib -type d -name tests -exec rm -rf {} + 2>/dev/null || true
find ${NB_PYTHON_PREFIX}/lib -type d -name test -exec rm -rf {} + 2>/dev/null || true
find ${NB_PYTHON_PREFIX}/lib -name '*.pyc' -delete 2>/dev/null || true
find ${NB_PYTHON_PREFIX}/lib -type d -name __pycache__ -exec rm -rf {} + 2>/dev/null || true
find ${NB_PYTHON_PREFIX}/lib -name '*.so' -exec strip --strip-unneeded {} + 2>/dev/null || true
rm -rf ${NB_PYTHON_PREFIX}/share/{doc,man,gtk-doc} 2>/dev/null || true
