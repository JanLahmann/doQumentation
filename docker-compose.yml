services:
  # Static site only (nginx, ~60 MB)
  # Usage: docker compose --profile web up
  web:
    build: .
    ports:
      - "8080:80"
    profiles: ["web"]
    restart: unless-stopped

  # Full stack: static site + Jupyter + Qiskit (~3 GB)
  # Code execution works through nginx proxy on port 80 (mapped to 8080).
  # Port 8888 exposes JupyterLab directly (requires token).
  # A random token is generated at startup â€” see container logs.
  # Usage: docker compose --profile jupyter up
  # Fixed token: JUPYTER_TOKEN=mytoken docker compose --profile jupyter up
  jupyter:
    build:
      context: .
      dockerfile: Dockerfile.jupyter
    ports:
      - "8080:80"
      - "8888:8888"
    environment:
      - JUPYTER_TOKEN=${JUPYTER_TOKEN:-}
    profiles: ["jupyter"]
    restart: unless-stopped
